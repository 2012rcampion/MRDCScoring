<html>
	<head>
		<title>Control Panel</title>
		<script src='jquery-1.11.0.js'></script>
		<script src='/socket.io/socket.io.js'></script>
		<script>
			var teamData = [];
			
			$(document).ready(function() {
				
				socket = io.connect(location.hostname);
				
				$('#startTimer').on('click', function() {
					socket.emit('startTimer');
				});
				
				$('#stopTimer').on('click', function() {
					socket.emit('stopTimer');
				});
				
				$('#resetTimer').on('click', function() {
					socket.emit('resetTimer');
				});
				
				$('#setTimer').on('click', function() {
					socket.emit('setTimer',$('#timerInput').val());
				});
				
				$('#resetGame').on('click', function() {
					socket.emit('resetGame');
				});
				
				$('#createTeam').on('click', function() {
					socket.emit('setTimer',$('#timerInput').val());
				});
				
				var teamsDiv = $('#teams');
				for(var i = 0; i < 4; i++) {
					var listItem = $('<li></li>');
					listItem.html(
						'<span class=\'name\'>Team ' + (1+i) + '</span>' + 
						': <span class=\'score\'>0</span>'
					);
					listItem.data('team', i)
					listItem.on('click', function() {
						currentColor = +$(this).data('team');
						$(this).siblings().removeClass('selected');
						$(this).addClass('selected');
					});
					teamsDiv.append(listItem);
				}
				
				
				
				socket.on('stateUpdate', function(data) {
					
					var teams = $('#teams').children();
					for(var i = 0; i < teams.length; i++) {
						$(teams[i]).find('.name').html(data.teams[i].name);
						$(teams[i]).find('.score').html(data.teams[i].score);
					}
				});
				
				socket.on('timeUpdate', function(data) {
					var m = Math.floor(data/60000);
					var s = Math.floor(data/1000)-60*m;
					$('#time').html(m+':'+('0'+s).slice(-2));
				});
				
				socket.on('teamsUpdate', function(data) {
					teamData = data;
					var teamList = $('#teamList');
					teamList.find('li').remove();
					for(var i = 0; i < teamData.length; i++) {
						var t = teamData[i];
						var teamDiv = $('<li></li>');
						teamDiv.text(teamData[i].name +
							(t.multiplier == 1 ? '' : ' (x'+t.multiplier+')'));
						teamList.append(teamDiv);
					}
				});
			
			});
		</script>
	</head>
	<body>
		<h2>Current Game</h2>
		<span id='time'></span>
		<button id='startTimer'>Start</button>
		<button id='stopTimer'>Pause</button>
		<button id='resetTimer'>Reset</button>
		<button id='setTimer'>Set to:</button>
		<input id='timerInput'></input><br/>
		
		<ul id='teams'></ul>
		<button id='resetGame'>Reset Game</button><br/>
		
		<h2>Teams</h2>
		
		<ul id='teamList'>
		</ul>
		New team:<br/>
		Name: <input id='newTeamName'></input><br/>
		Multiplier: <input id='newTeamMultiplier'></input>(defaults to 1)
		<button id='createTeam'>Create Team</button>
		
		<div style="border:1px dotted red;width:1022px;height:766px;position:fixed;left:0;top:0;z-index:-100;background-color:magenta">
	</body>
</html>
